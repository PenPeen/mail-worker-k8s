apiVersion: apps/v1
kind: Deployment
metadata:
  name: unleash
  labels:
    app: unleash
spec:
  replicas: 1
  selector:
    matchLabels:
      app: unleash
  template:
    metadata:
      labels:
        app: unleash
    spec:
      containers:
      - name: unleash
        image: unleashorg/unleash-server:5.7.0
        ports:
        - containerPort: 4242
        env:
        - name: DATABASE_URL
          value: "postgres://unleash:password@unleash-postgres:5432/unleash"
        - name: DATABASE_SSL
          value: "false"
        - name: LOG_LEVEL
          value: "info"
        - name: INIT_ADMIN_API_TOKENS
          value: "*:*.unleash-insecure-admin-api-token"
        resources:
          requests:
            cpu: 100m
            memory: 256Mi
          limits:
            cpu: 500m
            memory: 512Mi
---
apiVersion: v1
kind: Service
metadata:
  name: unleash
spec:
  selector:
    app: unleash
  ports:
  - port: 4242
    targetPort: 4242
  type: LoadBalancer