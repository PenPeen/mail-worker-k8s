# ArgoCD管理画面操作マニュアル

## ページ概要

### URL
https://localhost:8080/applications/argocd/mail-app

### 概要
ArgoCDのアプリケーション詳細画面では、GitOpsによってデプロイされたKubernetesアプリケーションの状態を監視・管理できます。mail-appアプリケーションの同期状態、ヘルス状態、リソース構成を視覚的に確認し、必要に応じて手動同期やロールバックなどの操作を実行できます。

### 主な画面要素
- **アプリケーション情報パネル**: APP HEALTH、SYNC STATUS、LAST SYNCの情報を表示
- **操作ボタン群**: Details、Sync、Sync Status、History and rollback、Delete、Refreshボタン
- **表示切替タブ**: Tree、Pods、Network、Listの4つのビュー
- **リソースフィルター**: NAME、KINDS、SYNC STATUS、HEALTH STATUSでのフィルタリング機能

## 各種ボタンの機能

### DETAILS
- **機能**: アプリケーションの詳細情報を右側パネルに表示
- **表示内容**:
  - プロジェクト情報、クラスター情報、リポジトリURL
  - 同期ポリシー設定（自動同期、プルーン、セルフヒール）
  - アノテーション、作成日時、パス情報
- **利用方法**: ボタンをクリックすると詳細パネルが開く

### SYNC
- **機能**: 手動同期の実行設定画面を表示
- **利用方法**: ボタンをクリック後、設定を確認してSynchronizeボタンで実行

#### 基本設定
- **Revision**: 同期対象のGitリビジョン（デフォルト：HEAD）
- **Synchronize**: 同期実行ボタン
- **Cancel**: 同期をキャンセル

#### 同期オプション
- **Prune**: Gitにないリソースを削除（手動作成されたリソースの清掃）
- **Dry Run**: 実際には実行せず、変更内容のプレビューのみ（結果はSync Statusパネルで確認）
- **Apply Only**: 新規作成・更新のみ実行（削除は行わない）
- **Force**: 通常の同期で失敗する場合の強制実行

#### 詳細同期オプション
- **Skip Schema Validation**: スキーマ検証をスキップ
- **Auto-Create Namespace**: 存在しないNamespaceを自動作成
- **Prune Last**: 削除処理を最後に実行
- **Apply Out of Sync Only**: 同期されていないリソースのみ適用
- **Respect Ignore Differences**: 差分無視設定を尊重
- **Server-Side Apply**: サーバーサイドでのApply実行
- **Prune Propagation Policy**: 削除時の伝播ポリシー（foreground/background/orphan）
- **Replace**: リソースの置換実行

#### リトライ設定
- **Retry**: リトライ機能の有効/無効
- **Limit**: リトライ回数上限（デフォルト：5）
- **Duration**: 初回リトライ間隔（デフォルト：5s）
- **Max Duration**: 最大リトライ間隔（デフォルト：3m）
- **Factor**: リトライ間隔の倍率（デフォルト：2）

#### リソース選択
- **all / out of sync / none**: 一括選択オプション
- **個別チェックボックス**: 各リソースの同期対象選択
- **リソース状態表示**: 各リソースの現在の同期状態を表示

#### 実際の活用例
- **ImagePullBackOff解決**: 問題のあるDeploymentのみ選択して再同期
- **設定変更の事前確認**: Dry Runで変更内容を事前チェック
- **手動リソース削除**: Pruneオプションで不要リソースを清掃
- **特定リビジョンへの同期**: Revisionを指定してロールバック的な使用
- **強制同期**: 通常同期で失敗する場合のForceオプション使用

### SYNC STATUS
- **機能**: 最新の同期操作の詳細状況を表示
- **表示内容**:
  - 操作種別、フェーズ、メッセージ
  - 開始時刻、終了時刻、実行時間
  - 各リソースの同期結果（HEALTH、STATUS、HOOK、MESSAGE）
- **利用方法**: ボタンをクリックすると同期状況パネルが開く

### HISTORY AND ROLLBACK
- **機能**: デプロイ履歴の表示とロールバック機能
- **表示内容**:
  - デプロイ日時、デプロイ時間、実行者
  - リビジョン情報、コミット詳細
  - アクティブ期間
- **利用方法**: ボタンをクリックすると履歴パネルが開く

### DELETE
- **機能**: アプリケーションの削除
- **注意**: 実行前に十分な確認が必要

### REFRESH
- **機能**: 画面情報の最新化
- **利用方法**: ボタンをクリックして最新状態を取得

## SYNC STATUS（同期状態）

### Synced
- **意味**: GitリポジトリとKubernetesクラスターの状態が一致
- **表示**: 緑色のアイコンで表示
- **対応**: 正常な状態のため特別な対応は不要

### OutOfSync
- **意味**: GitリポジトリとKubernetesクラスターの状態が不一致
- **表示**: オレンジ色のアイコンで表示
- **対応**: 手動同期またはAuto Syncの有効化を検討

## HEALTH STATUS（ヘルス状態）

### Progressing
- **意味**: リソースがデプロイ中または更新中
- **表示**: 青色の回転アイコン
- **対応**: 処理完了まで待機、必要に応じて進行状況を監視

### Suspended
- **意味**: リソースが一時停止状態
- **表示**: 一時停止アイコン
- **対応**: 意図的な停止でない場合は原因調査が必要

### Healthy
- **意味**: リソースが正常に動作中
- **表示**: 緑色のチェックマーク
- **対応**: 正常な状態のため特別な対応は不要

### Degraded
- **意味**: リソースに問題が発生（例：イメージプルエラー）
- **表示**: 赤色の警告アイコン
- **対応**: エラー詳細を確認し、問題の解決が必要

### Missing
- **意味**: 期待されるリソースが存在しない
- **表示**: グレーのアイコン
- **対応**: リソースの再作成または設定確認が必要

### Unknown
- **意味**: ヘルス状態が不明
- **表示**: グレーの疑問符アイコン
- **対応**: リソースの状態確認が必要

## 表示ビューの種類

### Tree（ツリービュー）
- **概要**: リソース間の依存関係を階層構造で表示
- **利用方法**: リソースの関連性を把握したい場合に使用
- **特徴**: Application → Deployment → ReplicaSet → Podの階層が視覚的に分かりやすい

### Pods（ポッドビュー）
- **概要**: Podの配置状況をノード別に表示
- **利用方法**: Pod の分散状況やノードリソース使用状況を確認
- **特徴**: CPU/MEMの使用状況とPodのヘルス状態を同時に確認可能

### Network（ネットワークビュー）
- **概要**: ネットワーク関連リソース（Pod、Service）を表示
- **利用方法**: サービス間の通信やネットワーク構成を確認
- **特徴**: ServiceとPodの関連性が視覚的に表示される

### List（リストビュー）
- **概要**: 全リソースをテーブル形式で一覧表示
- **利用方法**: 詳細情報を一覧で確認したい場合に使用
- **特徴**: NAME、GROUP/KIND、NAMESPACE、CREATED AT、STATUSを表形式で表示

## ユースケース

### 日常監視
1. **アプリケーション状態確認**: APP HEALTHとSYNC STATUSを確認
2. **リソース状態確認**: Tree/Listビューでリソースの状態を確認
3. **問題発生時**: Degradedリソースの詳細を確認し、必要に応じて対処

### デプロイ作業
1. **手動同期**: Syncボタンから同期設定を行い実行
2. **同期状況確認**: Sync Statusで同期の進行状況を監視
3. **結果確認**: 同期完了後、各リソースの状態を確認

### トラブルシューティング
1. **履歴確認**: History and rollbackで過去のデプロイ履歴を確認
2. **詳細調査**: Detailsボタンで設定情報を確認
3. **ロールバック**: 必要に応じて過去のリビジョンにロールバック

## 注意点

### セキュリティ
- Delete操作は慎重に実行し、事前に影響範囲を確認する
- 本番環境での手動同期は変更管理プロセスに従って実行する

### 運用
- Auto Syncが有効な場合、手動変更は自動的に上書きされる可能性がある
- Refreshボタンで定期的に最新状態を確認する
- Degraded状態のリソースは速やかに原因調査と対処を行う

### パフォーマンス
- 大量のリソースがある場合、Listビューの表示に時間がかかる場合がある
- フィルター機能を活用して必要なリソースのみを表示する
